<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>B: Design Patterns in Ruby | windse7en</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Design Patterns in RubyGoF(Gang of Four) book: Design Patterns: Elements of Reusable Object-Oriented Software.
prefer composition to inheritancy. Internal Domain-Specific Language(DSL), metaprogrammin">
<meta property="og:type" content="article">
<meta property="og:title" content="B: Design Patterns in Ruby">
<meta property="og:url" content="http://yoursite.com/2015/07/17/book-design-patterns-in-ruby/index.html">
<meta property="og:site_name" content="windse7en">
<meta property="og:description" content="Design Patterns in RubyGoF(Gang of Four) book: Design Patterns: Elements of Reusable Object-Oriented Software.
prefer composition to inheritancy. Internal Domain-Specific Language(DSL), metaprogrammin">
<meta property="og:image" content="http://snag.gy/vkB9S.jpg">
<meta property="og:image" content="http://snag.gy/fkwNm.jpg">
<meta property="og:image" content="http://snag.gy/PXBE1.jpg">
<meta property="og:image" content="http://snag.gy/Qtwd2.jpg">
<meta property="og:image" content="http://snag.gy/ybQ34.jpg">
<meta property="og:image" content="http://snag.gy/RNTAs.jpg">
<meta property="og:image" content="http://snag.gy/uSoFP.jpg">
<meta property="og:image" content="http://snag.gy/oCtix.jpg">
<meta property="og:image" content="http://snag.gy/DvfH4.jpg">
<meta property="og:image" content="http://snag.gy/2fCuf.jpg">
<meta property="og:image" content="http://snag.gy/vuATB.jpg">
<meta property="og:image" content="http://snag.gy/BXYm8.jpg">
<meta property="og:image" content="http://snag.gy/qis6x.jpg">
<meta property="og:image" content="http://snag.gy/il4mO.jpg">
<meta property="og:image" content="http://snag.gy/7jOFa.jpg">
<meta property="og:updated_time" content="2017-02-26T16:16:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="B: Design Patterns in Ruby">
<meta name="twitter:description" content="Design Patterns in RubyGoF(Gang of Four) book: Design Patterns: Elements of Reusable Object-Oriented Software.
prefer composition to inheritancy. Internal Domain-Specific Language(DSL), metaprogrammin">
<meta name="twitter:image" content="http://snag.gy/vkB9S.jpg">
  
    <link rel="alternative" href="/atom.xml" title="windse7en" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.2d7529.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

</head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="null" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">Tao Zhang</a></h1>
		</hgroup>
		
		<p class="header-subtitle">while(1){slef++;}</p>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/随笔/">随笔</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="#" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">Tao Zhang</h1>
			</hgroup>
			
			<p class="header-subtitle"><i class="icon icon-quo-left"></i>while(1){slef++;}<i class="icon icon-quo-right"></i></p>
			
			
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 50%"><a href="/">主页</a></li>
		        
					<li style="width: 50%"><a href="/tags/随笔/">随笔</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-book-design-patterns-in-ruby" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      B: Design Patterns in Ruby
    </h1>
  

        
        <a href="/2015/07/17/book-design-patterns-in-ruby/" class="archive-article-date">
  	<time datetime="2015-07-17T19:08:30.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2015-07-17</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Design-Patterns-in-Ruby"><a href="#Design-Patterns-in-Ruby" class="headerlink" title="Design Patterns in Ruby"></a>Design Patterns in Ruby</h1><p>GoF(Gang of Four) book: <em>Design Patterns: Elements of Reusable Object-Oriented Software.</em></p>
<p>prefer composition to inheritancy. Internal Domain-Specific Language(DSL), metaprogramming, convention not configuration</p>
<p>怎么用？<br>How do you add features to your program without turning the whole thing into a huge, unmanageable mess? So far, you have seen how to split the internal workings of your objects up among a family of classes with the Template Method pattern and how to use the Strategy pattern to split off whole chunks of algorithms. You have also seen how to react to requests coming into your objects with the Command pattern and how to keep up with changes made to other objects with the Observer pattern. Composites and iterators each help in their own way in dealing with collections of objects.</p>
<p>14 Design Patterns:</p>
<ol>
<li>Template Method:      Every pattern has a problem that it is trying to solve. For example, perhaps your code always wants to do exactly the same thing, except at step 44. Sometimes step 44 wants to do this, and sometimes it wants to do that. Perhaps you need a Template Method.</li>
<li>Strategy object:      Maybe it is not step 44 that wants to vary but the whole algorithm. You have a well-defined job, something that needs to get done, but there are a lot of ways to do it. You might need to remove the outer covering from a feline creature, and there is more than one technique you might employ. You might want to wrap those techniques—those algorithms—in a Strategy object.</li>
<li>Observer Pattern:     What if you have a class A, which needs to know what is happening over there in class B? But you don’t want to couple the two classes together because you never know when class C (or even class D!) might come along. You might want to consider using the Observer pattern.</li>
<li>Composition Pattern:  Sometimes you need to treat a collection of objects just like a single object—I can delete or copy or move an individual file, but I can also delete or copy or move a whole directory of files. If you need to build a collection of objects that looks just like one of the individual objects, you probably need the Composite pattern.</li>
<li>Iterator Pattern:     Now suppose you are writing some code that hides a collection of objects, but you don’t want the collection hidden too well:                                                                                                                                                                                                                                                             You would like your client to be able to access the objects in your collection in sequence without knowing how or where you have stored those objects. You definitely need the Iterator pattern.</li>
<li>Command Pattern:      Sometimes we need to wrap instructions in a kind of a postcard:                                                                                                                                                                                                                                                                                                                          Dear database, when you get this, delete row number 7843. Postcards are hard to come by in code, but the Command pattern is tailor made for this situation.</li>
<li>Adapter:              What do you do when an object does what you need it to do, but its interface is wrong? Your interface mismatch might be very deep and complex, or it might be as simple as needing an object that can write but having an object that calls it save. The GoF would recommend an Adapter to you.</li>
<li>Proxy:                Maybe you have the right object, but it is over there, someplace else on the network, and you don’t want the client code to care about its location. Or perhaps you want to delay creating your object as long as possible, or control access to it. In this circumstance, you may need a Proxy.</li>
<li>Decorator:            Sometimes you need to add responsibilities to your objects on the fly, at runtime. If you have a need for objects that implement some core capabilities but must sometimes take on additional responsibilities, perhaps you need the Decorator pattern.</li>
<li>Singleton:            Perhaps you have an instance of a class, and it needs to be the only instance of that class—that is, the single instance that everybody uses. Sounds like you have a Singleton.</li>
<li>Factory Method:       Now suppose you are writing a base class, one that is meant to be extended. As you are happily coding away at your base class, you realize that it needs to produce a new object and only the subclass will know exactly which kind of object to produce. You may need a Factory Method here.</li>
<li>Abstract Factory:     How do you create families of compatible objects? Suppose you have a system that models various types of cars, but not all engines are compatible with all fuel or cooling systems. How do you ensure that you don’t end up with the automotive equivalent of Frankenstein’s monster? You might build a class devoted to creating all of those objects and call it an Abstract Factory.</li>
<li>Builder:              Perhaps you are building an object so complex that its construction requires a significant bit of code. Even worse, the process of construction needs to vary according to the circumstances. Perhaps you need the Builder pattern?</li>
<li>Interpreter:          Ever have the feeling that you are using the wrong programming language to solve your problem? As crazy as it sounds, perhaps you should stop trying to solve your problem directly and build an Interpreter for a language that solves your problem more easily.</li>
</ol>
<h1 id="Chapter-3-Verying-the-Algorithm-with-the-Template-Method"><a href="#Chapter-3-Verying-the-Algorithm-with-the-Template-Method" class="headerlink" title="Chapter 3. Verying the Algorithm with the Template Method"></a>Chapter 3. Verying the Algorithm with the Template Method</h1><p>Thought: Separate the things that stay the same.</p>
<p>Template Method Patterm Example, hook methods:<br><img src="http://snag.gy/vkB9S.jpg"></p>
<h2 id="Templates-in-the-Wild"><a href="#Templates-in-the-Wild" class="headerlink" title="Templates in the Wild"></a>Templates in the Wild</h2><p>WEBrick, 跑一个httpserver用到了Template，可以overrite run method。</p>
<h1 id="Chapter-4-Replacing-the-Algorithm-with-the-Strategy"><a href="#Chapter-4-Replacing-the-Algorithm-with-the-Strategy" class="headerlink" title="Chapter 4. Replacing the Algorithm with the Strategy"></a>Chapter 4. Replacing the Algorithm with the Strategy</h1><p>加入了Strategy对象来描述<br><img src="http://snag.gy/fkwNm.jpg"></p>
<p>Strategy 就指得是一些知道how to do something的executable code。就像Proc(&amp;proc_variable)<br>就像sort的使用就用的是Strategy Pattern，穿进去Proc知道怎么排序</p>
<p>Ruby rdoc 用的就是Strategy Pattern<br><img src="http://snag.gy/PXBE1.jpg"></p>
<h2 id="Strategy-in-the-Wild"><a href="#Strategy-in-the-Wild" class="headerlink" title="Strategy in the Wild"></a>Strategy in the Wild</h2><p>Ruby 中rdoc用Strategy Pattern来定义显示format</p>
<h1 id="Chapter-5-Keeping-up-with-the-Times-with-the-Observer"><a href="#Chapter-5-Keeping-up-with-the-Times-with-the-Observer" class="headerlink" title="Chapter 5. Keeping up with the Times with the Observer"></a>Chapter 5. Keeping up with the Times with the Observer</h1><p>Core Challenge: building a system that is highly integrated that a system where every part is aware of the sate of the whole.<br>P.104 Explain the observer module</p>
<img src="http://snag.gy/Qtwd2.jpg">
<h2 id="Observer-in-the-Wild"><a href="#Observer-in-the-Wild" class="headerlink" title="Observer in the Wild"></a>Observer in the Wild</h2><p>ActiveRecord::Observer中用Observer来观察database records，created，read，written and deleted。</p>
<h1 id="Chapter-6-Assembling-the-Whole-from-the-Parts-with-the-Composite"><a href="#Chapter-6-Assembling-the-Whole-from-the-Parts-with-the-Composite" class="headerlink" title="Chapter 6. Assembling the Whole from the Parts with the Composite"></a>Chapter 6. Assembling the Whole from the Parts with the Composite</h1><p>Core Challenge: build up bigger objects from small sub-objects, which might themseleve be made up of still smaller sub-sub-objects.</p>
<img src="http://snag.gy/ybQ34.jpg">
<h2 id="Sprucing-Up-the-Composite-with-Operators"><a href="#Sprucing-Up-the-Composite-with-Operators" class="headerlink" title="Sprucing Up the Composite with Operators"></a>Sprucing Up the Composite with Operators</h2><p>It turns out that we can get this done by simply renaming the add_sub_task method:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">composite = CompositeTask.new(‘example’)</div><div class="line">composite &lt;&lt; MixTask.new</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">&lt;&lt;</span><span class="params">(task)</span></span></div><div class="line">  @sub_tasks &lt;&lt; task</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">[]</span><span class="params">(index)</span></span></div><div class="line">  @sub_tasks[index]</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">[]=</span><span class="params">(index, new_value)</span></span></div><div class="line">  @sub_tasks[index] = new_value</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="An-Inconvenient-Difference"><a href="#An-Inconvenient-Difference" class="headerlink" title="An Inconvenient Difference"></a>An Inconvenient Difference</h2><p>How to handle the difference between the leaf and the composite:</p>
<ol>
<li>leaf和composite不一样，addChild，deleteChild这样的方法leaf没有</li>
<li>leaf也加入这两种方法，但是如果被调用了怎么响应是个问题，ignore，exception，还是怎么样？</li>
</ol>
<p>最容易犯的问题：<br>Mistake：容易把Composite当成one level deeper，但实际上，composite是multiple levels的。</p>
<h2 id="Composites-in-the-Wild"><a href="#Composites-in-the-Wild" class="headerlink" title="Composites in the Wild"></a>Composites in the Wild</h2><p>在Ruby中，GUI libraries就是基于Composite Pattern实现的。</p>
<h1 id="Chapter-7-Reaching-into-a-Collection-with-the-Iterator"><a href="#Chapter-7-Reaching-into-a-Collection-with-the-Iterator" class="headerlink" title="Chapter 7. Reaching into a Collection with the Iterator"></a>Chapter 7. Reaching into a Collection with the Iterator</h1><p>Core Challenge: allows an aggregate object to provide the outsite wolrd with a way to access its collection of subobjects.</p>
<h2 id="External-Iterators"><a href="#External-Iterators" class="headerlink" title="External Iterators"></a>External Iterators</h2><p>Java’s iterator is external iterator, ‘external’- a separate object from the aggregate</p>
<h2 id="Internal-Iterators"><a href="#Internal-Iterators" class="headerlink" title="Internal Iterators"></a>Internal Iterators</h2><p>Ruby’s iterator, inside the aggregate object, the code block-based iterators.</p>
<h2 id="The-Inimitable-Enumerable"><a href="#The-Inimitable-Enumerable" class="headerlink" title="The Inimitable Enumerable"></a>The Inimitable Enumerable</h2><p>要实现iterator在ruby中，一般就include Enumerable方法，有了，覆盖each和&lt;=&gt;方法。<br>包括方法：all?, any?, include? …</p>
<h2 id="Using-and-Abusing-the-Iterator-Pattern"><a href="#Using-and-Abusing-the-Iterator-Pattern" class="headerlink" title="Using and Abusing the Iterator Pattern"></a>Using and Abusing the Iterator Pattern</h2><p>Mistake: What happens if the aggregate object changes while you are iterating through it?</p>
<h2 id="Iterators-in-the-Wild"><a href="#Iterators-in-the-Wild" class="headerlink" title="Iterators in the Wild"></a>Iterators in the Wild</h2><p>Ruby的各种each method</p>
<p>IO object，File.open(), Pathname.new，都是很好的iterator</p>
<p>ObjectSpace module each_object 显示interpreter中的所有object。<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ObjectSpace.each_object &#123; <span class="params">|o|</span> puts “<span class="symbol">Object:</span> <span class="comment">#&#123;o&#125;” &#125;</span></div></pre></td></tr></table></figure></p>
<h1 id="Chapter-8-Getting-Things-Done-with-Commands"><a href="#Chapter-8-Getting-Things-Done-with-Commands" class="headerlink" title="Chapter 8. Getting Things Done with Commands"></a>Chapter 8. Getting Things Done with Commands</h1><p>Core Challenge: an instruction to do something, something specific when something happens.</p>
<img src="http://snag.gy/RNTAs.jpg">
<h2 id="Using-and-Abusing-the-Command-Pattern"><a href="#Using-and-Abusing-the-Command-Pattern" class="headerlink" title="Using and Abusing the Command Pattern"></a>Using and Abusing the Command Pattern</h2><p>The key thing about the Command pattern is that it separates the thought from the deed. When you use this pattern, you are no longer simply saying, “Do this”; instead, you are saying, “Remember how to do this,” and, sometime later, “Do that thing that I told you to remember.”<br>用的太频繁，本来很简单的内容用pattern去实现了。</p>
<h2 id="The-Command-Pattern-in-the-Wild"><a href="#The-Command-Pattern-in-the-Wild" class="headerlink" title="The Command Pattern in the Wild"></a>The Command Pattern in the Wild</h2><p>ActiveRecord Migrations, up, down, change, Madeleine</p>
<h1 id="Chapter-9-Filling-in-the-Gaps-with-the-Adapter"><a href="#Chapter-9-Filling-in-the-Gaps-with-the-Adapter" class="headerlink" title="Chapter 9. Filling in the Gaps with the Adapter"></a>Chapter 9. Filling in the Gaps with the Adapter</h1><p>Core Chanllenge: bridge the gap between mismatching software interfaces. Ruby 运行时修改类和对象来创建adapter。</p>
<p>Adapter就是用来帮你给你要用的和你有的interface搭桥的。<br><img src="http://snag.gy/uSoFP.jpg"></p>
<p>Ruby中可以对实例添加方法的实例：<br><img src="http://snag.gy/oCtix.jpg"></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">bto = BritishTextObject.new(‘hello’, <span class="number">50.8</span>, <span class="symbol">:blue</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> &lt;&lt; bto</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">color</span></span></div><div class="line">    colour</div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">text</span></span></div><div class="line">    string</div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">size_inches</span></span></div><div class="line">    <span class="keyword">return</span> size_mm/<span class="number">25.4</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bto</span>.<span class="title">color</span></span></div><div class="line">  colour</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bto</span>.<span class="title">text</span></span></div><div class="line">  string</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="Using-and-Abusing-the-Adapter-Pattern"><a href="#Using-and-Abusing-the-Adapter-Pattern" class="headerlink" title="Using and Abusing the Adapter Pattern"></a>Using and Abusing the Adapter Pattern</h2><p>It’s hard to call a method client decided but you didn’t think you needed.我很奇怪这个问题在哪里。</p>
<h2 id="Adapters-in-the-Wild"><a href="#Adapters-in-the-Wild" class="headerlink" title="Adapters in the Wild"></a>Adapters in the Wild</h2><p>ActiveRecord, AbstractAdapter 用来解决数据库的adapter的问题。</p>
<h1 id="Chapter-10-Getting-in-Front-of-Your-Object-with-a-Proxy"><a href="#Chapter-10-Getting-in-Front-of-Your-Object-with-a-Proxy" class="headerlink" title="Chapter 10. Getting in Front of Your Object with a Proxy"></a>Chapter 10. Getting in Front of Your Object with a Proxy</h1><p>Core Chanllenge: controll access to an object or providing a location-independent way of getting at the object or delaying its creations.</p>
<img src="http://snag.gy/DvfH4.jpg">
<p>Protection proxy 可以把check安全性的和功能性的放到一个class里面，这样以后容易修改。</p>
<p>RPC system soap/wsdl get weather information.</p>
<h2 id="Message-passing"><a href="#Message-passing" class="headerlink" title="Message passing"></a>Message passing</h2><p>method_missing(:symbol__name, *args), 方法名和参数</p>
<h2 id="Using-and-Abusing-Proxies"><a href="#Using-and-Abusing-Proxies" class="headerlink" title="Using and Abusing Proxies"></a>Using and Abusing Proxies</h2><p>As method_missing is slow and obsure for the code.</p>
<h2 id="Proxies-in-the-Wild"><a href="#Proxies-in-the-Wild" class="headerlink" title="Proxies in the Wild"></a>Proxies in the Wild</h2><p>Ruby SOAP, Ruby package method<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">class MathService</div><div class="line">  def add(a, b)</div><div class="line">    return a + b</div><div class="line">  end</div><div class="line">end</div><div class="line"></div><div class="line">require ‘drb/drb’</div><div class="line"></div><div class="line">math_service=MathService.new</div><div class="line">DRb.start_service(“druby://localhost:3030”, math_service)</div><div class="line">DRb.thread.join</div></pre></td></tr></table></figure></p>
<p>client part:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">require ‘drb/drb’</div><div class="line">DRb.start_service</div><div class="line"></div><div class="line">math_service = DRbObject.new_with_uri(“druby://localhost:3030”)</div><div class="line"></div><div class="line">sum=math_service.add(2,2)</div></pre></td></tr></table></figure></p>
<h2 id="Wrapping-Up-Pattern"><a href="#Wrapping-Up-Pattern" class="headerlink" title="Wrapping Up Pattern"></a>Wrapping Up Pattern</h2><p>主要解决的三个问题：</p>
<ol>
<li>保护对象，授权通信  protection proxy</li>
<li>隐藏对象在其他地方  remote proxy</li>
<li>延迟创建复杂对象    virtual proxy</li>
</ol>
<h1 id="Chapter-11-Improving-your-objects-with-a-decorator"><a href="#Chapter-11-Improving-your-objects-with-a-decorator" class="headerlink" title="Chapter 11. Improving your objects with a decorator"></a>Chapter 11. Improving your objects with a decorator</h1><p>Core Chanllenge: add an enhancement to an existing object.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">writer = CheckSummingWriter.new(TimeStampingWriter.new(NumberingWriter.new(SimpleWriter.new(‘final.txt’))))</div><div class="line">writer.write_line(‘Hello out there’)</div></pre></td></tr></table></figure>
<img src="http://snag.gy/2fCuf.jpg">
<p>extend Forwardable module for delegating the methods(use extend to add class-level methods)<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> ‘forwardable’</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WriterDecorator</span></span></div><div class="line">  extend Forwardable</div><div class="line">  def_delegators <span class="symbol">:</span>@real_writer, <span class="symbol">:write_line</span>, <span class="symbol">:rewind</span>, <span class="symbol">:pos</span>, <span class="symbol">:close</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(real_writer)</span></span></div><div class="line">    @real_writer = real_writer</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="Using-and-Abusing-the-Decorator-Pattern"><a href="#Using-and-Abusing-the-Decorator-Pattern" class="headerlink" title="Using and Abusing the Decorator Pattern"></a>Using and Abusing the Decorator Pattern</h2><ol>
<li>harder to debug, different decorator class,</li>
<li>multiplying the number of objects floating around in your program创建对象太多了。</li>
</ol>
<h2 id="Decorators-in-the-Wild"><a href="#Decorators-in-the-Wild" class="headerlink" title="Decorators in the Wild"></a>Decorators in the Wild</h2><p>ActiveRecord 中有个alias_method_chain, 可以改变老的方法的名字，和新的进行置换。<br>链式修改，在所有修改装饰之后才调用开始类的输出。</p>
<h1 id="Chapter-12-Making-sure-there-is-only-one-with-the-Singleton"><a href="#Chapter-12-Making-sure-there-is-only-one-with-the-Singleton" class="headerlink" title="Chapter 12. Making sure there is only one with the Singleton"></a>Chapter 12. Making sure there is only one with the Singleton</h1><p> Core Chanllenge: there are some things that are unique.</p>
<p> 实现Singleton的三种方法：</p>
<ol>
<li>include singleton module</li>
<li>Global variable and constant technique</li>
<li>class as singleton</li>
<li><p>Module as singleton</p>
<p>Singleton: 只有一个、全局可用的实例</p>
</li>
</ol>
<p>@@variable for the class cariable. Java中是static</p>
<p>def self.method for the class method.</p>
<p>Ruby里面Singleton的使用过程，include之后，直接用SimpleLogger.instance得到唯一值<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> ‘singleton’</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpleLogger</span></span></div><div class="line">  <span class="keyword">include</span> Singleton</div><div class="line">  <span class="comment"># Lots of code deleted...</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="Using-and-Abusing-the-Singleton-Pattern"><a href="#Using-and-Abusing-the-Singleton-Pattern" class="headerlink" title="Using and Abusing the Singleton Pattern"></a>Using and Abusing the Singleton Pattern</h2><ol>
<li>How many of the singletons needed?</li>
<li>Singletons on a need-to-know basis</li>
<li>Cure the Testing Blues. As singleton called by multiple class, there will be a lot independence.</li>
</ol>
<h2 id="Singletons-in-the-Wild"><a href="#Singletons-in-the-Wild" class="headerlink" title="Singletons in the Wild"></a>Singletons in the Wild</h2><p>rake, Inflections(单复数的), are singletons </p>
<h1 id="Chapter-13-Picking-the-Right-Class-with-a-Factory"><a href="#Chapter-13-Picking-the-Right-Class-with-a-Factory" class="headerlink" title="Chapter 13. Picking the Right Class with a Factory"></a>Chapter 13. Picking the Right Class with a Factory</h1><p>Core Challenge: How to pick the right class for the circumstance?</p>
<img src="http://snag.gy/vuATB.jpg">
<p>It just likes the templete pattern, share a common type. Because they implement a common set of methods.</p>
<h2 id="Parameterize-Factory-Methods"><a href="#Parameterize-Factory-Methods" class="headerlink" title="Parameterize Factory Methods"></a>Parameterize Factory Methods</h2><p>Give many parameters to the factory methods, use case switch to define which class to call.</p>
<p>Pond Example:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pond</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(number_animals, animal_class, number_plants, plant_class)</span></span></div><div class="line">    @animal_class = animal_class</div><div class="line">    @plant_class = plant_class</div><div class="line">    @animals = []</div><div class="line">    number_animals.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">      animal = new_organism(<span class="symbol">:animal</span>, “Animal<span class="comment">#&#123;i&#125;”)</span></div><div class="line">      @animals &lt;&lt; animal</div><div class="line">    <span class="keyword">end</span></div><div class="line">    @plants = []</div><div class="line">    number_plants.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">      plant = new_organism(<span class="symbol">:plant</span>, “Plant<span class="comment">#&#123;i&#125;”)</span></div><div class="line">      @plants &lt;&lt; plant</div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">simulate_one_day</span></span></div><div class="line">    @plants.each &#123;<span class="params">|plant|</span> plant.grow&#125;</div><div class="line">    @animals.each &#123;<span class="params">|animal|</span> animal.speak&#125;</div><div class="line">    @animals.each &#123;<span class="params">|animal|</span> animal.eat&#125;</div><div class="line">    @animals.each &#123;<span class="params">|animal|</span> animal.sleep&#125;</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new_organism</span><span class="params">(type, name)</span></span></div><div class="line">    <span class="keyword">if</span> type == <span class="symbol">:animal</span></div><div class="line">      @animal_class.new(name)</div><div class="line">    <span class="keyword">elsif</span> type == <span class="symbol">:plant</span></div><div class="line">      @plant_class.new(name)</div><div class="line">    <span class="keyword">else</span></div><div class="line">      raise “Unknown organism <span class="symbol">type:</span> <span class="comment">#&#123;type&#125;”</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>An object dedicated to creating a compatible set of objects is called an abstract factory.<br>一个用来创建一堆对象的对象:Abstract Factory</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PondOrganismFactory</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new_animal</span><span class="params">(name)</span></span></div><div class="line">    Frog.new(name)</div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new_plant</span><span class="params">(name)</span></span></div><div class="line">    Algae.new(name)</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">JungleOrganismFactory</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new_animal</span><span class="params">(name)</span></span></div><div class="line">    Tiger.new(name)</div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new_plant</span><span class="params">(name)</span></span></div><div class="line">    Tree.new(name)</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Habitat</span></span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(number_animals, number_plants, organism_factory)</span></span></div><div class="line">  @organism_factory = organism_factory</div><div class="line">  @animals = []</div><div class="line">  number_animals.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">    animal = @organism_factory.new_animal(“Animal<span class="comment">#&#123;i&#125;”)</span></div><div class="line">    @animals &lt;&lt; animal</div><div class="line">  <span class="keyword">end</span></div><div class="line">  @plants = []</div><div class="line">  number_plants.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">    plant = @organism_factory.new_plant(“Plant<span class="comment">#&#123;i&#125;”)</span></div><div class="line">    @plants &lt;&lt; plant</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<img src="http://snag.gy/BXYm8.jpg">
<p>In the same way that the Factory Method pattern is really the Template Method pattern applied to object creation, so the Abstract Factory pattern is simply the Strategy pattern applied to the same problem.</p>
<h2 id="Using-and-Abusing-the-Factory-Patterns"><a href="#Using-and-Abusing-the-Factory-Patterns" class="headerlink" title="Using and Abusing the Factory Patterns"></a>Using and Abusing the Factory Patterns</h2><p>Balance the cost of the additional.</p>
<h2 id="Factory-Patterns-in-the-Wild"><a href="#Factory-Patterns-in-the-Wild" class="headerlink" title="Factory Patterns in the Wild"></a>Factory Patterns in the Wild</h2><p>ActiveRecord::Base use Factory Pattern to map the database connection.</p>
<h1 id="Chapter-14-Easier-Object-Construction-with-the-Builder"><a href="#Chapter-14-Easier-Object-Construction-with-the-Builder" class="headerlink" title="Chapter 14. Easier Object Construction with the Builder"></a>Chapter 14. Easier Object Construction with the Builder</h1><p>Core Chanllenge: a pattern designed to help you configure those complex objects.</p>
<img src="http://snag.gy/qis6x.jpg">
<h2 id="Polymorphic-Builders"><a href="#Polymorphic-Builders" class="headerlink" title="Polymorphic Builders"></a>Polymorphic Builders</h2><p>Builder 更关注怎么configure object而不是pick right class。<br><img src="http://snag.gy/il4mO.jpg"></p>
<p>通过method_missing方法，支持，例如add_trubo_adn_dvd_and_harddisk这样的方法<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">method_missing</span><span class="params">(name, *args)</span></span></div><div class="line">  words = name.to_s.split(“<span class="number">_</span>”)</div><div class="line">  <span class="keyword">return</span> <span class="keyword">super</span>(name, *args) unless words.shift == ‘add’</div><div class="line">  words.each <span class="keyword">do</span> <span class="params">|word|</span></div><div class="line">    <span class="keyword">next</span> <span class="keyword">if</span> word == ‘<span class="keyword">and</span>’</div><div class="line">    add_cd <span class="keyword">if</span> word == ‘cd’</div><div class="line">    add_dvd <span class="keyword">if</span> word == ‘dvd’</div><div class="line">    add_hard_disk(<span class="number">100000</span>) <span class="keyword">if</span> word == ‘harddisk’</div><div class="line">    turbo <span class="keyword">if</span> word == ‘turbo’</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h2 id="Using-and-Abusing-the-Builder-Pattern"><a href="#Using-and-Abusing-the-Builder-Pattern" class="headerlink" title="Using and Abusing the Builder Pattern"></a>Using and Abusing the Builder Pattern</h2><p>不太复杂的事情结果用Builder造成complex。</p>
<h2 id="Builders-in-the-Wild"><a href="#Builders-in-the-Wild" class="headerlink" title="Builders in the Wild"></a>Builders in the Wild</h2><p>MailFactory in ruby, config the mail and send it.</p>
<h1 id="Chapter-15-Assembling-your-system-with-the-interpreter"><a href="#Chapter-15-Assembling-your-system-with-the-interpreter" class="headerlink" title="Chapter 15. Assembling your system with the interpreter"></a>Chapter 15. Assembling your system with the interpreter</h1><p>Core Chanllenge: need an interpreter for a domain problem.</p>
<p>What kind of problems are good candidates for the Interpreter pattern? As a general rule, problems well suited to the Interpreter pattern tend to be selfcontained, with crisp boundaries around them. For example, if you are writing code that searches for specific objects based on some specification, you might consider creating a query language.1 Conversely, if you are faced with the task of creating complex object configurations, you might think about building a configuration language. Another clue that your problem might be right for the Interpreter pattern is that you find yourself creating lots of discrete chunks of code, chunks that seem easy enough to write in themselves<br>什么问题需要Interpreter Pattern呢？</p>
<ol>
<li>当这个问题可以被更小的边界包含的时候，例如需要对特殊对象的查询，query language，需要复杂配置，configuration language。</li>
<li>另一个是，你发现有很多离散的可重复代码块。</li>
</ol>
<h2 id="Building-an-Interpreter"><a href="#Building-an-Interpreter" class="headerlink" title="Building an Interpreter"></a>Building an Interpreter</h2><img src="http://snag.gy/7jOFa.jpg">
<ol>
<li>AST: abstract syntax tree. </li>
</ol>
<p>If the language is fairly complex and neither XML nor YAML seems appropriate, using a parser generator Racc.</p>
<h2 id="Using-and-Abusing-the-interpreter-Pattern"><a href="#Using-and-Abusing-the-interpreter-Pattern" class="headerlink" title="Using and Abusing the interpreter Pattern"></a>Using and Abusing the interpreter Pattern</h2><ol>
<li>The complexity issure, how complex your language will be.</li>
<li>Program efficiency. good choice for 80% code that really is performance insensitive.</li>
</ol>
<h2 id="Interpreters-in-the-wild"><a href="#Interpreters-in-the-wild" class="headerlink" title="Interpreters in the wild"></a>Interpreters in the wild</h2><p>Regular Expression for string matching.</p>
<p>Runt: expressing things like date and time ranges and schedules.</p>
<h1 id="Chapter-16-Opening-Up-Your-System-with-Domain-Specific-Languages"><a href="#Chapter-16-Opening-Up-Your-System-with-Domain-Specific-Languages" class="headerlink" title="Chapter 16. Opening Up Your System with Domain-Specific Languages"></a>Chapter 16. Opening Up Your System with Domain-Specific Languages</h1><p>Core Chanllenge: provider the language that used by the users.</p>
<h2 id="Using-and-Abusing-the-DSL"><a href="#Using-and-Abusing-the-DSL" class="headerlink" title="Using and Abusing the DSL"></a>Using and Abusing the DSL</h2><ol>
<li>error message is unfriendly.</li>
<li>If security is an issue, stay away from internal DSLs.</li>
</ol>
<h2 id="Internal-DSLs-in-the-Wild"><a href="#Internal-DSLs-in-the-Wild" class="headerlink" title="Internal DSLs in the Wild"></a>Internal DSLs in the Wild</h2><p>rake, task based on tasks. </p>
<h1 id="Chapter-17-Creating-Custom-Objects-with-Meta-programming"><a href="#Chapter-17-Creating-Custom-Objects-with-Meta-programming" class="headerlink" title="Chapter 17. Creating Custom Objects with Meta-programming"></a>Chapter 17. Creating Custom Objects with Meta-programming</h1><p>Core Chanllenge: Change the functionality in the runtime.</p>
<p>Use extend for the object insludes some module.对象mix Module用extend，class包含module用include。</p>
<p>The subclasses of Base do not automatically inherit any Composite pattern behavior. Instead, they inherit the member_of and composite_of class method to add the composite methods to the subclass.</p>
<h2 id="Using-and-Abusing-Meta-programming"><a href="#Using-and-Abusing-Meta-programming" class="headerlink" title="Using and Abusing Meta-programming"></a>Using and Abusing Meta-programming</h2><p>Meta-programming: writing programs that augment or change themseleves as they run.<br>The key danger is the unexpected interaction between features.</p>
<h2 id="Meta-programming-in-the-Wild"><a href="#Meta-programming-in-the-Wild" class="headerlink" title="Meta-programming in the Wild"></a>Meta-programming in the Wild</h2><p>attr_reader, attr_writer, attr_accessor. The three are meta-programming. like:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">readable_attribute</span><span class="params">(name)</span></span></div><div class="line">    code = <span class="string">%Q&#123;</span></div><div class="line">      def <span class="subst">#&#123;name&#125;</span></div><div class="line">        @<span class="subst">#&#123;name&#125;</span></div><div class="line">      end</div><div class="line">    &#125;</div><div class="line">    class_eval(code)</div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BankAccount</span></span></div><div class="line">  readable_attribute <span class="symbol">:balance</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(balance)</span></span></div><div class="line">    @balance = balance</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>Forwardable module to delegae the methods.</p>
<h1 id="Chapter-18-Convention-Over-Configuration"><a href="#Chapter-18-Convention-Over-Configuration" class="headerlink" title="Chapter 18. Convention Over Configuration"></a>Chapter 18. Convention Over Configuration</h1><p>Core Chanllenge: How to make software systems extensible via configuration.</p>
<ol>
<li>Convention focuses to making it wasy to add adapters.</li>
<li>Some constraints on the adapter.</li>
</ol>
<h2 id="Using-and-Abusing-the-Convention-Over-Configuration-Pattern"><a href="#Using-and-Abusing-the-Convention-Over-Configuration-Pattern" class="headerlink" title="Using and Abusing the Convention Over Configuration Pattern"></a>Using and Abusing the Convention Over Configuration Pattern</h2><ol>
<li>The convention might be incomplete.</li>
<li>hard to write and no documentation for the operational road map.</li>
</ol>
<h1 id="Chapter-19-Conclusion"><a href="#Chapter-19-Conclusion" class="headerlink" title="Chapter 19. Conclusion"></a>Chapter 19. Conclusion</h1>
      

      
        <div class="page-reward">
          <a href="javascript:;" class="page-reward-btn tooltip-top">
            <div class="tooltip tooltip-east">
            <span class="tooltip-item">
              赏
            </span>
            <span class="tooltip-content">
              <span class="tooltip-text">
                <span class="tooltip-inner">
                  <p class="reward-p"><i class="icon icon-quo-left"></i>谢谢你请我吃糖果<i class="icon icon-quo-right"></i></p>
                  <div class="reward-box">
                    
                    
                  </div>
                </span>
              </span>
            </span>
          </div>
          </a>
        </div>
      
    </div>
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/ruby/" class="article-tag-list-link color5">ruby</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="/categories/designpattern/" class="article-tag-list-link color5">design pattern</a>
        		</li>
      		
		</ul>
	</div>


      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="http://s.jiathis.com/qrcode.php?url=http://yoursite.com/2015/07/17/book-design-patterns-in-ruby/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2015/07/22/learn-linux-command-tips/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          Learn: linux command tips
        
      </div>
    </a>
  
  
    <a href="/2015/07/16/practical-obect-oriented-design-in-ruby/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Practical Obect Oriented Design in Ruby</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>






  
    <div class="duoshuo"></div>
  




          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 Tao Zhang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="./",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,n){var e=/\/|index.html/g;return t.replace(e,"")===n.replace(e,"")}function i(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,e=0,r=t.length;e<r;e++){var i=t[e];o(n,i.getAttribute("href"))&&(0,d.default)(i,"active")}}function u(t){for(var n=t.offsetLeft,e=t.offsetParent;null!==e;)n+=e.offsetLeft,e=e.offsetParent;return n}function f(t){for(var n=t.offsetTop,e=t.offsetParent;null!==e;)n+=e.offsetTop,e=e.offsetParent;return n}function c(t,n,e,r,o){var i=u(t),c=f(t)-n;if(c-e<=o){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,h.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(e||c)+"px",a.style.left=i+"px",a.style.zIndex=r||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");c(t,document.body.scrollTop,-63,2,0),c(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}function l(){x.default.versions.mobile&&window.screen.width<800&&(i(),s())}var p=e(71),d=r(p),v=e(72),y=(r(v),e(84)),h=r(y),b=e(69),x=r(b),m=e(75),g=r(m),w=e(70);l(),(0,w.addLoadEvent)(function(){g.default.init()}),t.exports={}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){var r=e(49),o=e(15);t.exports=function(t){return r(o(t))}},function(t,n,e){t.exports=!e(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(6),o=e(12);t.exports=e(4)?function(t,n,e){return r.f(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(10),o=e(30),i=e(24),u=Object.defineProperty;n.f=e(4)?Object.defineProperty:function(t,n,e){if(r(t),n=i(n,!0),r(e),o)try{return u(t,n,e)}catch(t){}if("get"in e||"set"in e)throw TypeError("Accessors not supported!");return"value"in e&&(t[n]=e.value),t}},function(t,n,e){var r=e(22)("wks"),o=e(13),i=e(1).Symbol,u="function"==typeof i,f=t.exports=function(t){return r[t]||(r[t]=u&&i[t]||(u?i:o)("Symbol."+t))};f.store=r},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,e){var r=e(35),o=e(16);t.exports=Object.keys||function(t){return r(t,o)}},function(t,n,e){var r=e(11);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,e){var r=e(6).f,o=e(2),i=e(7)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){var r=e(22)("keys"),o=e(13);t.exports=function(t){return r[t]||(r[t]=o(t))}},function(t,n,e){var r=e(1),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){var r=e(11);t.exports=function(t,n){if(!r(t))return t;var e,o;if(n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;if("function"==typeof(e=t.valueOf)&&!r(o=e.call(t)))return o;if(!n&&"function"==typeof(e=t.toString)&&!r(o=e.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,n,e){var r=e(1),o=e(14),i=e(18),u=e(26),f=e(6).f;t.exports=function(t){var n=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==t.charAt(0)||t in n||f(n,t,{value:u.f(t)})}},function(t,n,e){n.f=e(7)},function(t,n,e){var r=e(1),o=e(14),i=e(46),u=e(5),f="prototype",c=function(t,n,e){var a,s,l,p=t&c.F,d=t&c.G,v=t&c.S,y=t&c.P,h=t&c.B,b=t&c.W,x=d?o:o[n]||(o[n]={}),m=x[f],g=d?r:v?r[n]:(r[n]||{})[f];d&&(e=n);for(a in e)s=!p&&g&&void 0!==g[a],s&&a in x||(l=s?g[a]:e[a],x[a]=d&&"function"!=typeof g[a]?e[a]:h&&s?i(l,r):b&&g[a]==l?function(t){var n=function(n,e,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,e)}return new t(n,e,r)}return t.apply(this,arguments)};return n[f]=t[f],n}(l):y&&"function"==typeof l?i(Function.call,l):l,y&&((x.virtual||(x.virtual={}))[a]=l,t&c.R&&m&&!m[a]&&u(m,a,l)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n,e){var r=e(11),o=e(1).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){t.exports=!e(4)&&!e(8)(function(){return 7!=Object.defineProperty(e(29)("div"),"a",{get:function(){return 7}}).a})},function(t,n,e){"use strict";var r=e(18),o=e(27),i=e(36),u=e(5),f=e(2),c=e(17),a=e(51),s=e(20),l=e(58),p=e(7)("iterator"),d=!([].keys&&"next"in[].keys()),v="@@iterator",y="keys",h="values",b=function(){return this};t.exports=function(t,n,e,x,m,g,w){a(e,n,x);var O,S,_,j=function(t){if(!d&&t in A)return A[t];switch(t){case y:return function(){return new e(this,t)};case h:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",E=m==h,M=!1,A=t.prototype,T=A[p]||A[v]||m&&A[m],L=T||j(m),N=m?E?j("entries"):L:void 0,C="Array"==n?A.entries||T:T;if(C&&(_=l(C.call(new t)),_!==Object.prototype&&(s(_,P,!0),r||f(_,p)||u(_,p,b))),E&&T&&T.name!==h&&(M=!0,L=function(){return T.call(this)}),r&&!w||!d&&!M&&A[p]||u(A,p,L),c[n]=L,c[P]=b,m)if(O={values:E?L:j(h),keys:g?L:j(y),entries:N},w)for(S in O)S in A||i(A,S,O[S]);else o(o.P+o.F*(d||M),n,O);return O}},function(t,n,e){var r=e(10),o=e(55),i=e(16),u=e(21)("IE_PROTO"),f=function(){},c="prototype",a=function(){var t,n=e(29)("iframe"),r=i.length,o="<",u=">";for(n.style.display="none",e(48).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write(o+"script"+u+"document.F=Object"+o+"/script"+u),t.close(),a=t.F;r--;)delete a[c][i[r]];return a()};t.exports=Object.create||function(t,n){var e;return null!==t?(f[c]=r(t),e=new f,f[c]=null,e[u]=t):e=a(),void 0===n?e:o(e,n)}},function(t,n,e){var r=e(35),o=e(16).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(2),o=e(3),i=e(45)(!1),u=e(21)("IE_PROTO");t.exports=function(t,n){var e,f=o(t),c=0,a=[];for(e in f)e!=u&&r(f,e)&&a.push(e);for(;n.length>c;)r(f,e=n[c++])&&(~i(a,e)||a.push(e));return a}},function(t,n,e){t.exports=e(5)},function(t,n,e){var r=e(15);t.exports=function(t){return Object(r(t))}},function(t,n,e){t.exports={default:e(41),__esModule:!0}},function(t,n,e){t.exports={default:e(42),__esModule:!0}},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var o=e(39),i=r(o),u=e(38),f=r(u),c="function"==typeof f.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":typeof t};n.default="function"==typeof f.default&&"symbol"===c(i.default)?function(t){return"undefined"==typeof t?"undefined":c(t)}:function(t){return t&&"function"==typeof f.default&&t.constructor===f.default&&t!==f.default.prototype?"symbol":"undefined"==typeof t?"undefined":c(t)}},function(t,n,e){e(65),e(63),e(66),e(67),t.exports=e(14).Symbol},function(t,n,e){e(64),e(68),t.exports=e(26).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(3),o=e(61),i=e(60);t.exports=function(t){return function(n,e,u){var f,c=r(n),a=o(c.length),s=i(u,a);if(t&&e!=e){for(;a>s;)if(f=c[s++],f!=f)return!0}else for(;a>s;s++)if((t||s in c)&&c[s]===e)return t||s||0;return!t&&-1}}},function(t,n,e){var r=e(43);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n,e){var r=e(9),o=e(34),i=e(19);t.exports=function(t){var n=r(t),e=o.f;if(e)for(var u,f=e(t),c=i.f,a=0;f.length>a;)c.call(t,u=f[a++])&&n.push(u);return n}},function(t,n,e){t.exports=e(1).document&&document.documentElement},function(t,n,e){var r=e(28);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(28);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,n,e){"use strict";var r=e(32),o=e(12),i=e(20),u={};e(5)(u,e(7)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r=e(9),o=e(3);t.exports=function(t,n){for(var e,i=o(t),u=r(i),f=u.length,c=0;f>c;)if(i[e=u[c++]]===n)return e}},function(t,n,e){var r=e(13)("meta"),o=e(11),i=e(2),u=e(6).f,f=0,c=Object.isExtensible||function(){return!0},a=!e(8)(function(){return c(Object.preventExtensions({}))}),s=function(t){u(t,r,{value:{i:"O"+ ++f,w:{}}})},l=function(t,n){if(!o(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,r)){if(!c(t))return"F";if(!n)return"E";s(t)}return t[r].i},p=function(t,n){if(!i(t,r)){if(!c(t))return!0;if(!n)return!1;s(t)}return t[r].w},d=function(t){return a&&v.NEED&&c(t)&&!i(t,r)&&s(t),t},v=t.exports={KEY:r,NEED:!1,fastKey:l,getWeak:p,onFreeze:d}},function(t,n,e){var r=e(6),o=e(10),i=e(9);t.exports=e(4)?Object.defineProperties:function(t,n){o(t);for(var e,u=i(n),f=u.length,c=0;f>c;)r.f(t,e=u[c++],n[e]);return t}},function(t,n,e){var r=e(19),o=e(12),i=e(3),u=e(24),f=e(2),c=e(30),a=Object.getOwnPropertyDescriptor;n.f=e(4)?a:function(t,n){if(t=i(t),n=u(n,!0),c)try{return a(t,n)}catch(t){}if(f(t,n))return o(!r.f.call(t,n),t[n])}},function(t,n,e){var r=e(3),o=e(33).f,i={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(t){try{return o(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==i.call(t)?f(t):o(r(t))}},function(t,n,e){var r=e(2),o=e(37),i=e(21)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,e){var r=e(23),o=e(15);t.exports=function(t){return function(n,e){var i,u,f=String(o(n)),c=r(e),a=f.length;return c<0||c>=a?t?"":void 0:(i=f.charCodeAt(c),i<55296||i>56319||c+1===a||(u=f.charCodeAt(c+1))<56320||u>57343?t?f.charAt(c):i:t?f.slice(c,c+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r=e(23),o=Math.max,i=Math.min;t.exports=function(t,n){return t=r(t),t<0?o(t+n,0):i(t,n)}},function(t,n,e){var r=e(23),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){"use strict";var r=e(44),o=e(52),i=e(17),u=e(3);t.exports=e(31)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n){},function(t,n,e){"use strict";var r=e(59)(!0);e(31)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){"use strict";var r=e(1),o=e(2),i=e(4),u=e(27),f=e(36),c=e(54).KEY,a=e(8),s=e(22),l=e(20),p=e(13),d=e(7),v=e(26),y=e(25),h=e(53),b=e(47),x=e(50),m=e(10),g=e(3),w=e(24),O=e(12),S=e(32),_=e(57),j=e(56),P=e(6),E=e(9),M=j.f,A=P.f,T=_.f,L=r.Symbol,N=r.JSON,C=N&&N.stringify,k="prototype",F=d("_hidden"),q=d("toPrimitive"),I={}.propertyIsEnumerable,B=s("symbol-registry"),D=s("symbols"),W=s("op-symbols"),H=Object[k],K="function"==typeof L,R=r.QObject,J=!R||!R[k]||!R[k].findChild,U=i&&a(function(){return 7!=S(A({},"a",{get:function(){return A(this,"a",{value:7}).a}})).a})?function(t,n,e){var r=M(H,n);r&&delete H[n],A(t,n,e),r&&t!==H&&A(H,n,r)}:A,G=function(t){var n=D[t]=S(L[k]);return n._k=t,n},$=K&&"symbol"==typeof L.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof L},z=function(t,n,e){return t===H&&z(W,n,e),m(t),n=w(n,!0),m(e),o(D,n)?(e.enumerable?(o(t,F)&&t[F][n]&&(t[F][n]=!1),e=S(e,{enumerable:O(0,!1)})):(o(t,F)||A(t,F,O(1,{})),t[F][n]=!0),U(t,n,e)):A(t,n,e)},Y=function(t,n){m(t);for(var e,r=b(n=g(n)),o=0,i=r.length;i>o;)z(t,e=r[o++],n[e]);return t},Q=function(t,n){return void 0===n?S(t):Y(S(t),n)},X=function(t){var n=I.call(this,t=w(t,!0));return!(this===H&&o(D,t)&&!o(W,t))&&(!(n||!o(this,t)||!o(D,t)||o(this,F)&&this[F][t])||n)},V=function(t,n){if(t=g(t),n=w(n,!0),t!==H||!o(D,n)||o(W,n)){var e=M(t,n);return!e||!o(D,n)||o(t,F)&&t[F][n]||(e.enumerable=!0),e}},Z=function(t){for(var n,e=T(g(t)),r=[],i=0;e.length>i;)o(D,n=e[i++])||n==F||n==c||r.push(n);return r},tt=function(t){for(var n,e=t===H,r=T(e?W:g(t)),i=[],u=0;r.length>u;)!o(D,n=r[u++])||e&&!o(H,n)||i.push(D[n]);return i};K||(L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),n=function(e){this===H&&n.call(W,e),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),U(this,t,O(1,e))};return i&&J&&U(H,t,{configurable:!0,set:n}),G(t)},f(L[k],"toString",function(){return this._k}),j.f=V,P.f=z,e(33).f=_.f=Z,e(19).f=X,e(34).f=tt,i&&!e(18)&&f(H,"propertyIsEnumerable",X,!0),v.f=function(t){return G(d(t))}),u(u.G+u.W+u.F*!K,{Symbol:L});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),et=0;nt.length>et;)d(nt[et++]);for(var nt=E(d.store),et=0;nt.length>et;)y(nt[et++]);u(u.S+u.F*!K,"Symbol",{for:function(t){return o(B,t+="")?B[t]:B[t]=L(t)},keyFor:function(t){if($(t))return h(B,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){J=!0},useSimple:function(){J=!1}}),u(u.S+u.F*!K,"Object",{create:Q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:V,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),N&&u(u.S+u.F*(!K||a(function(){var t=L();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!$(t)){for(var n,e,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return n=r[1],"function"==typeof n&&(e=n),!e&&x(n)||(n=function(t,n){if(e&&(n=e.call(this,t,n)),!$(n))return n}),r[1]=n,C.apply(N,r)}}}),L[k][q]||e(5)(L[k],q,L[k].valueOf),l(L,"Symbol"),l(Math,"Math",!0),l(r.JSON,"JSON",!0)},function(t,n,e){e(25)("asyncIterator")},function(t,n,e){e(25)("observable")},function(t,n,e){e(62);for(var r=e(1),o=e(5),i=e(17),u=e(7)("toStringTag"),f=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],c=0;c<5;c++){var a=f[c],s=r[a],l=s&&s.prototype;l&&!l[u]&&o(l,u,a),i[a]=i.Array}},function(t,n){"use strict";var e={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")==-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:t.indexOf("Safari")==-1,weixin:t.indexOf("MicroMessenger")==-1}}()};t.exports=e},function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}var o=e(40),i=r(o),u=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):o[t]||t}function n(t){return l[t]}var e=/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,r=/['<> "&]/g,o={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},f=/\u00a0/g,c=/<br\s*\/?>/gi,a=/\r?\n/g,s=/\s/g,l={};for(var p in o)l[o[p]]=p;return o["&apos;"]="'",l["'"]="&#39;",{encode:function(t){return t?(""+t).replace(r,n).replace(a,"<br/>").replace(s,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(c,"\n").replace(e,t).replace(f," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],e=0,r=t.length;r>e;e++)n.push(t.charCodeAt(e).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],e=0,r=t.length;r>e;e+=2)n.push(String.fromCharCode("0x"+t.slice(e,e+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,e=t.length;e>n;n++)t[n]=u.encodeObject(t[n]);else if("object"==("undefined"==typeof t?"undefined":(0,i.default)(t)))for(var r in t)t[r]=u.encodeObject(t[r]);else if("string"==typeof t)return u.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=u},function(t,n){function e(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=e},function(t,n){function e(t,n){if(t.classList)t.classList.remove(n);else{var e=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(e," ")}}t.exports=e},,,function(t,n){"use strict";function e(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){var n=document.querySelectorAll(".article-entry a:not(.article-more-a)");n.forEach(function(t){t.setAttribute("target","_blank")})}var e=document.querySelector("#js-aboutme");e&&0!==e.length&&(e.innerHTML=e.innerText)}t.exports={init:e}},,,,,,,,,function(t,n){function e(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var e=t.nextSibling;return e?t.parentNode.insertBefore(n,e):t.parentNode.appendChild(n)}t.exports=e}])</script><script src="/./main.2d7529.js"></script><script>!function(){var e=function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)};e("/slider.885efe.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            2、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: true
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接1</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接2</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接3</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接4</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接5</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接6</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">很惭愧&lt;br&gt;&lt;br&gt;只做了一点微小的工作&lt;br&gt;谢谢大家</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>